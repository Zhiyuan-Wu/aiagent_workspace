# 标签设计优化实验计划

## 1. 背景与动机

### 1.1 当前标签的局限性

**当前实现**（`data_handler.py`）：
```python
# 当前标签定义
LABEL0 = Ref($close, -2) / Ref($close, -1) - 1  # 未来2日收益率
```

**主要问题**：
1. **时间周期单一**：仅考虑2日后的收益，未探索不同持有期
2. **噪声敏感性高**：2日收益率受短期随机波动影响大
3. **未考虑风险**：仅关注收益大小，忽略波动性和最大回撤
4. **目标错位**：排序学习与实际投资目标（如夏普比率）不完全一致

### 1.2 优化目标

通过标签设计优化，在固定数据（200+因子，CSI300股票池，2017-2020测试集）基础上，提升模型在以下方面的表现：

- **预测准确性**：更高的IC/Rank IC
- **排序稳定性**：更低的IC标准差，更高的ICIR
- **投资实用性**：与真实投资目标（风险调整收益）更一致

---

## 2. 实验设计原则

### 2.1 固定条件

为避免混淆变量，以下参数在所有实验中保持固定：

- **特征**：使用现有200+因子（不做任何修改）
- **模型**：使用LGBM基线模型（避免模型架构干扰）
- **排序方法**：自适应边界聚焦（使用实验验证的最优参数）
- **数据范围**：2017-2020年测试集
- **训练数据**：2008-2014年训练集，2015-2016年验证集
- **随机种子**：固定为42（确保可复现性）

### 2.2 评估标准

- **主要指标**：年化收益率（用于选择最优标签设计）
- **辅助指标**：IC、Rank IC、夏普比率、最大回撤、ICIR

### 2.3 模型复用策略

**阶段0：Baseline标签训练**（仅需一次）
```
训练参数：
- 模型类型：LGBM
- 标签类型：当前2日收益率
- 保存路径：data/models/label_baseline_lgbm.pkl
```

**后续实验：加载模型并仅修改标签**
```
所有后续实验：
- 加载预训练模型
- 仅修改标签计算逻辑
- 重新训练（快速）或直接修改预测目标
```

---

## 3. 实验列表

### 实验 0: Baseline标签（当前2日收益率）

**目标**：建立基准性能

**设置描述**：
- 标签类型：未来2日收益率
- 计算方式：Ref($close, -2) / Ref($close, -1) - 1
- 标签范围：无限制（负无穷到正无穷）
- 损失函数：MSE

**预期性能**（基于历史运行）：
- IC: ~0.03-0.04
- 年化收益率: ~8-10%
- 夏普比率: ~0.8-1.0
- 最大回撤: ~30-35%

---

### 实验 1: 单周期长度对比

**目标**：确定最优的单周期长度

**变量**：收益率计算周期

**详细配置对比**：

**配置1: 1日收益率**
- 计算公式：Ref($close, -1) / Ref($close, 0) - 1
- 周期特点：响应最快，噪声最大
- 预期IC：较低（~0.02-0.03）
- 预期换手率：很高（>80%）
- 适用场景：震荡市，快速进出

**配置2: 2日收益率（Baseline）**
- 计算公式：Ref($close, -2) / Ref($close, -1) - 1
- 周期特点：平衡响应性和稳定性
- 预期IC：中等（~0.03-0.04）
- 预期换手率：高（60-70%）
- 适用场景：默认选择，通用性好

**配置3: 3日收益率**
- 计算公式：Ref($close, -3) / Ref($close, -1) - 1
- 周期特点：略微平滑，噪声减少
- 预期IC：略提升（~0.032-0.042）
- 预期换手率：中高（50-60%）
- 适用场景：轻度趋势市

**配置4: 5日收益率**
- 计算公式：Ref($close, -5) / Ref($close, -1) - 1
- 周期特点：一周交易周期，较稳定
- 预期IC：提升（~0.035-0.045）
- 预期换手率：中等（40-50%）
- 适用场景：稳定趋势市

**配置5: 10日收益率**
- 计算公式：Ref($close, -10) / Ref($close, -1) - 1
- 周期特点：两周周期，高度稳定
- 预期IC：中等（~0.033-0.043）
- 预期换手率：中低（30-40%）
- 适用场景：强趋势市

**配置6: 20日收益率**
- 计算公式：Ref($close, -20) / Ref($close, -1) - 1
- 周期特点：月度周期，高度稳定但滞后明显
- 预期IC：略降（~0.03-0.04）
- 预期换手率：低（20-30%）
- 适用场景：长期投资

**关键假设**：
- 短周期（1-3日）：捕捉短期动量，但噪声大导致IC较低且波动大
- 中周期（5-10日）：平衡稳定性与响应性，可能达到最优IC
- 长周期（20日）：高度稳定但滞后性明显，错过短期反转机会

**评估方法**：
- 绘制年化收益率 vs 周期长度曲线
- 绘制IC vs 周期长度曲线
- 绘制换手率 vs 周期长度曲线
- 寻找收益-换手率最优平衡点

---

### 实验 2: 多周期组合标签

**目标**：结合多个周期的信息，提升预测鲁棒性

**变量**：多周期加权组合方式

**详细配置对比**：

**配置1: 等权1-5-10日组合**
- 周期：1日、5日、10日
- 权重分配：[1/3, 1/3, 1/3]
- 计算方式：sum(weight_i × return_i) / sum(weights)
- 设计理念：平等对待不同时间尺度
- 预期效果：比单周期更稳定，IC标准差降低10-15%

**配置2: 短期优先组合**
- 周期：1日、5日、10日
- 权重分配：[0.5, 0.3, 0.2]
- 设计理念：更重视短期信号，快速响应市场变化
- 预期效果：响应快，换手率高，IC略提升
- 适用场景：震荡市，频繁反转

**配置3: 长期优先组合**
- 周期：1日、5日、10日
- 权重分配：[0.2, 0.3, 0.5]
- 设计理念：更重视长期趋势，平滑短期噪声
- 预期效果：稳定，换手率低，IC略降但ICIR提升
- 适用场景：趋势市

**配置4: 四周期等权组合**
- 周期：2日、5日、10日、20日
- 权重分配：[0.25, 0.25, 0.25, 0.25]
- 设计理念：覆盖更广的时间范围，全面性
- 预期效果：鲁棒性最强，IC标准差最低
- 适用场景：不确定市场环境

**配置5: 反比加权（短期权重大）**
- 周期：1日、5日、10日
- 权重计算：[1/1, 1/5, 1/10]归一化 → [0.62, 0.31, 0.07]
- 设计理念：强调短期变化，但权重差异平滑
- 预期效果：类似配置2但权重过渡更自然
- 优势：避免极端权重导致的过拟合

**配置6: 正比加权（长期权重大）**
- 周期：1日、5日、10日
- 权重计算：[1, 3, 5]归一化 → [0.11, 0.33, 0.56]
- 设计理念：强调长期稳定性，平滑短期波动
- 预期效果：类似配置3但权重差异更明显
- 优势：趋势捕捉能力强

**关键假设**：
- 多周期组合比单周期更稳定（IC标准差降低）
- 等权组合适合不确定市场环境
- 非等权组合（短期/长期优先）适用于特定市场状态（震荡/趋势）

**评估方法**：
- 对比所有配置的年化收益率
- 对比IC标准差和ICIR
- 分析不同市场环境下的表现差异
- 绘制权重分配热力图（组合×权重）

---

### 实验 3: 风险调整收益标签

**目标**：让模型学习风险调整后的收益，更符合投资目标

**变量**：风险调整方式

**详细配置对比**：

**配置1: Sharpe比率标签**
- 分子：未来5日收益率
- 分母：过去20日收益率波动率（标准差）
- 无风险利率：假设为0（简化）
- 计算公式：(future_return - 0) / historical_volatility
- 设计理念：单位波动率的收益，经典风险调整指标
- 预期效果：IC可能降低（更难预测），但夏普比率提升5-10%
- 优势：直接优化实际投资目标
- 风险：波动率计算可能受极端值影响

**配置2: Calmar比率标签**
- 分子：未来5日收益率
- 分母：abs(过去20日最大回撤)
- 计算公式：future_return / abs(max_drawdown_20d)
- 设计理念：单位最大回撤的收益，惩罚极端下跌
- 预期效果：IC可能降低，但最大回撤降低10-15%
- 优势：直接优化回撤控制
- 风险：最大回撤可能为0导致除零

**配置3: Sortino比率标签**
- 分子：未来5日收益率
- 分母：过去20日下行波动率（仅负收益日的标准差）
- 下行阈值：0%
- 无风险利率：假设为0
- 计算公式：(future_return - 0) / downside_deviation
- 设计理念：仅惩罚下跌波动，不惩罚上涨波动
- 预期效果：IC可能略降，Sortino比率提升8-12%
- 优势：更准确反映风险厌恶投资者的效用
- 特点：下行波动率<波动率，Sortino>Sharpe

**配置4: 信息比率标签**
- 分子：未来5日超额收益（相对于沪深300基准）
- 分母：超额收益的跟踪误差（标准差）
- 基准：沪深300指数
- 计算公式：excess_return / tracking_error
- 设计理念：相对基准的风险调整收益
- 预期效果：IC可能降低，但信息比率和相对表现提升
- 优势：适合有基准约束的主动管理
- 风险：需要引入基准数据

**配置5: 波动率调整收益**
- 计算公式：future_return / (1 + historical_volatility)
- 设计理念：简单的波动率惩罚，无需分母归一化
- 预期效果：轻微提升稳定性（最大回撤降低3-5%）
- 优势：计算简单，数值稳定
- 劣势：不如Sharpe比率理论严谨

**关键假设**：
- 风险调整标签更难预测（IC可能降低5-15%）
- 但应该提升实际投资的风险调整后收益指标
- Sharpe/Calmar/Sortino分别关注不同风险维度

**评估方法**：
- 主要对比各配置的风险调整后收益指标（Sharpe/Calmar/Sortino）
- 次要对比年化收益率（可能略降）
- 重点对比最大回撤（预期降低）
- 分析收益-风险散点图

---

### 实验 4: 排序标签（Rank Label）

**目标**：直接预测股票排序位次，而非收益率

**变量**：排序标签编码方式

**详细配置对比**：

**配置1: 原始排名（1-N）**
- 编码范围：1, 2, 3, ..., N（N为股票数量，约300）
- 生成方式：future_returns.rank(method='first')
- 损失函数：MSE
- 设计理念：保持原始排序信息
- 预期效果：稳定性提升（IC标准差降低），但丢失收益强度信息
- 优势：自然排序目标
- 劣势：标签范围大，模型学习困难

**配置2: 归一化排名（0-1）**
- 计算公式：(rank - 1) / (N - 1)
- 编码范围：[0, 1]
- 生成方式：先rank再归一化
- 损失函数：MSE
- 设计理念：统一到0-1范围，便于模型学习
- 预期效果：类似配置1，但训练更稳定（收敛更快）
- 优势：数值稳定，适合神经网络
- 劣势：仍然丢失收益强度

**配置3: 五分位数标签**
- 分位数边界：[0, 0.25, 0.5, 0.75, 1.0]
- 编码值：0, 0.25, 0.5, 0.75, 1.0
- 生成方式：pd.qcut(future_returns, 5, labels=False)
- 损失函数：MSE或Ordinal Regression
- 设计理念：粗粒度排序，降低噪声影响
- 预期效果：对异常值更鲁棒（IC提升2-5%）
- 优势：减少收益率噪声的干扰
- 劣势：损失排序精度

**配置4: 十分位数标签**
- 分位数边界：[0, 0.1, 0.2, ..., 0.9, 1.0]
- 编码值：0, 0.1, 0.2, ..., 0.9, 1.0
- 生成方式：pd.qcut(future_returns, 10, labels=False)
- 损失函数：MSE
- 设计理念：更细粒度，介于五分位数和连续值之间
- 预期效果：平衡鲁棒性和精度
- 优势：比五分位数保留更多信息
- 劣势：仍然对噪声敏感

**配置5: Top50分类标签**
- 编码值：1 if rank <= 50 else 0
- 生成方式：(rank <= 50).astype(float)
- 损失函数：Binary Cross Entropy
- 设计理念：二分类问题，直接优化Top-K准确性
- 预期效果：Top50准确率提升，但年化收益可能略降
- 优势：直接对齐投资目标（选前50只）
- 劣势：丢失50名以后的排序信息

**配置6: Top100分类标签**
- 编码值：1 if rank <= 100 else 0
- 生成方式：(rank <= 100).astype(float)
- 损失函数：Binary Cross Entropy
- 设计理念：更宽松的分类标准
- 预期效果：Top100准确率提升，年化收益可能略降
- 优势：适合更大投资组合
- 劣势：分类目标更简单

**关键假设**：
- 排序标签比收益率标签更稳定（减少收益率噪声影响）
- 但可能丢失收益强度信息（无法区分第1名和第2名的实际收益差异）
- Top-K分类可能提升Top-K股票的识别准确率
- 分位数标签（五/十分位）对异常值更鲁棒

**评估方法**：
- 主要对比Top-K准确率（Top50/100）
- 次要对比IC（可能略降）
- 对比年化收益率（可能略降2-5%）
- 分析预测排序 vs 真实排序散点图

---

### 实验 5: 分位数回归标签（Quantile Regression）

**目标**：预测股票在未来收益分布中的分位值

**变量**：目标分位数

**详细配置对比**：

**配置1: 25分位标签**
- 目标分位：0.25
- 含义：预测股票有25%概率低于此收益，75%概率高于此收益
- 损失函数：Quantile Loss（Pinball Loss）
- 损失公式：L(q) = max(q × e, (q - 1) × e)，其中e = y_true - y_pred
- 设计理念：关注下侧风险，保守预测
- 预期效果：年化收益略降（2-4%），但下行风险降低（最大回撤降低5-10%）
- 适用场景：风险厌恶投资者

**配置2: 50分位标签（中位数）**
- 目标分位：0.50
- 含义：预测股票的中位数收益（50%概率高于/低于）
- 损失函数：Quantile Loss
- 设计理念：对异常值不敏感（比均值更鲁棒）
- 预期效果：稳定性优于均值回归（IC标准差降低），年化收益可能略优（1-3%）
- 优势：理论上最鲁棒（中位数对异常值不敏感）
- 适用场景：一般投资者，平衡风险收益

**配置3: 75分位标签**
- 目标分位：0.75
- 含义：预测股票有75%概率低于此收益，25%概率高于此收益
- 损失函数：Quantile Loss
- 设计理念：关注上侧潜力，激进预测
- 预期效果：年化收益可能提升（2-5%），但波动率增加（最大回撤增加5-8%）
- 适用场景：风险偏好投资者

**配置4: 60分位标签**
- 目标分位：0.60
- 含义：略微偏向收益侧，但不过分激进
- 损失函数：Quantile Loss
- 设计理念：平衡保守与激进
- 预期效果：介于50和75分位之间
- 适用场景：一般投资者，轻微偏好收益

**配置5: 40分位标签**
- 目标分位：0.40
- 含义：略微偏向风险侧，但不过分保守
- 损失函数：Quantile Loss
- 设计理念：平衡保守与激进
- 预期效果：介于25和50分位之间
- 适用场景：一般投资者，轻微偏好稳定

**Quantile Loss关键特点**：
- 非对称损失：高估和低估的惩罚不同
- q=0.5（中位数）：对称损失，对异常值鲁棒
- q<0.5（如0.25）：低估惩罚>高估惩罚，保守预测
- q>0.5（如0.75）：高估惩罚>低估惩罚，激进预测

**关键假设**：
- 中位数（50分位）比均值更鲁棒（对异常值不敏感）
- 40-60分位可能最优（平衡保守与激进）
- 25分位适合风险厌恶，75分位适合风险偏好
- 不同分位数提供风险-收益权衡信息

**评估方法**：
- 对比各分位数的年化收益率
- 对比风险指标（波动率、最大回撤、Sortino比率）
- 分析分位数-收益散点图
- 绘制风险-收益权衡曲线

---

### 实验 6: 多目标标签

**目标**：同时优化多个目标（收益、风险、流动性等）

**变量**：目标组合与权重分配

**详细配置对比**：

**配置1: 收益+波动率**
- 目标1：未来5日收益率
- 目标2：过去20日收益率波动率（标准差）
- 权重分配：[1.0, -0.5]（要高收益，要低波动）
- 损失函数：MSE(y1, pred1) + 0.5 × MSE(y2, pred2)
- 设计理念：同时考虑收益和风险
- 预期效果：波动率降低（10-15%），年化收益可能略降（1-3%），夏普比率提升（3-8%）
- 优势：理论上更优的效用函数
- 劣势：需要调参权重配比

**配置2: 收益+流动性**
- 目标1：未来5日收益率
- 目标2：过去20日换手率
- 权重分配：[1.0, 0.3]（要好收益，偏好高流动性）
- 损失函数：MSE(y1, pred1) + 0.3 × MSE(y2, pred2)
- 设计理念：避免低流动性股票，降低交易成本
- 预期效果：换手率提升（股票流动性更好），净收益提升（扣除交易成本后3-7%）
- 优势：实用性强，考虑真实交易约束
- 劣势：流动性预测本身不稳定

**配置3: 收益+风险+流动性**
- 目标1：未来5日收益率
- 目标2：过去20日波动率
- 目标3：过去20日换手率
- 权重分配：[1.0, -0.5, 0.2]
- 损失函数：weighted sum of MSE
- 设计理念：全面考虑收益、风险、流动性
- 预期效果：最均衡的表现（夏普比率提升5-10%，净收益提升4-8%）
- 优势：考虑多个实际投资约束
- 劣势：权重调参复杂度高

**配置4: 收益+下行风险**
- 目标1：未来5日收益率
- 目标2：过去20日下行波动率（仅负收益日标准差）
- 权重分配：[1.0, -0.7]（重点惩罚下跌波动）
- 损失函数：MSE(y1, pred1) + 0.7 × MSE(y2, pred2)
- 设计理念：仅关注下跌风险，不惩罚上涨波动
- 预期效果：Sortino比率提升（8-12%），最大回撤降低（5-10%）
- 优势：更准确反映风险厌恶
- 劣势：下行波动率计算需要定义阈值

**配置5: 收益+最大回撤**
- 目标1：未来5日收益率
- 目标2：abs(过去20日最大回撤)
- 权重分配：[1.0, -0.3]（要高收益，惩罚极端下跌）
- 损失函数：MSE(y1, pred1) + 0.3 × MSE(y2, pred2)
- 设计理念：直接惩罚极端下跌事件
- 预期效果：最大回撤降低（10-15%），年化收益略降（2-4%）
- 优势：直接优化回撤控制
- 劣势：最大回撤为0时需要特殊处理

**配置6: 收益+行业集中度**
- 目标1：未来5日收益率
- 目标2：行业集中度（Herfindahl-Hirschman Index）
  - 计算：sum(行业权重^2)
  - 权重：基于股票所属行业市值占比
- 权重分配：[1.0, -0.4]（分散行业）
- 损失函数：MSE(y1, pred1) + 0.4 × MSE(y2, pred2)
- 设计理念：行业中性化倾向，降低行业风险
- 预期效果：行业暴露更均衡，不同行业环境下表现更稳定
- 优势：降低行业系统性风险
- 劣势：需要行业分类数据

**多目标学习关键特点**：
- 总损失=Σ(weight_i × loss_i)
- 不同目标可能有冲突（高收益 vs 低风险）
- 权重分配体现目标优先级
- 需要仔细调参找到最优权重

**关键假设**：
- 多目标学习可能找到更好的平衡点
- 但需要仔细调参（权重分配）
- 不同权重适用于不同风险偏好投资者

**评估方法**：
- 主要对比各配置的风险调整后收益（Sharpe/Calmar/Sortino）
- 次要对比年化收益率（可能略降）
- 重点对比换手率（流动性目标应降低换手）
- 绘制多目标帕累托前沿图（收益-风险-流动性）

---

### 实验 7: 自适应标签（根据市场环境动态调整）

**目标**：根据市场regime动态选择最优标签

**变量**：市场环境识别与标签切换策略

**详细配置对比**：

**配置1: 基于波动率切换**
- 环境识别指标：过去20日年化波动率
- 切换阈值：
  - 低波动率：<15%
  - 中等波动率：15-25%
  - 高波动率：>25%
- 标签选择策略：
  - 低波动：长周期标签（10日收益）
  - 高波动：短周期标签（2日收益）
  - 中等：中周期标签（5日收益）
- 设计理念：适应市场波动性，高波动时缩短持有期
- 预期效果：在不同波动率环境下均保持稳定，ICIR提升15-20%
- 优势：简单直观
- 劣势：阈值选择需要数据驱动优化

**配置2: 基于趋势强度切换**
- 环境识别指标：ADX（平均方向指数）
  - 计算：基于+DI和-DI
- 切换阈值：
  - 强趋势：ADX>25
  - 弱趋势：20<ADX<=25
  - 无趋势：ADX<=20
- 标签选择策略：
  - 强趋势：长周期标签（20日收益，跟随趋势）
  - 弱趋势：中周期标签（5日收益）
  - 无趋势：短周期标签（2日收益，快速响应）
- 设计理念：适应趋势强度，强趋势时持有更长
- 预期效果：趋势市表现更好（年化收益提升5-10%）
- 优势：利用趋势延续性
- 劣势：ADX计算复杂

**配置3: 基于市场方向切换**
- 环境识别指标：过去20日大盘涨跌幅（沪深300）
- 切换阈值：
  - 牛市：涨幅>10%
  - 熊市：跌幅<-10%
  - 震荡市：其他
- 标签选择策略：
  - 牛市：中周期标签（5日收益，把握机会）
  - 熊市：长周期标签（10日收益，更谨慎）
  - 震荡市：短周期标签（2日收益，快速进出）
- 设计理念：适应牛熊轮动
- 预期效果：牛熊市均有正收益（避免熊市大亏），年化收益提升3-7%
- 优势：简单有效
- 劣势：牛熊切换有滞后

**配置4: 动态多周期权重**
- 环境识别指标：过去20日年化波动率
- 权重调整策略：
  - 低波动率（<15%）：权重=[0.2, 0.3, 0.5]（偏长期：1日、5日、10日）
  - 高波动率（>25%）：权重=[0.5, 0.3, 0.2]（偏短期）
  - 中等波动率：权重=[1/3, 1/3, 1/3]（等权）
- 设计理念：动态调整多周期权重
- 预期效果：自适应平衡，ICIR提升10-15%
- 优势：平滑过渡，避免突变
- 劣势：权重计算复杂

**配置5: 基于市场情绪切换**
- 环境识别指标：过去5日换手率（情绪代理）
- 切换阈值：
  - 恐慌：换手率异常高（>平均值+2倍标准差）
  - 贪婪：换手率异常低（<平均值-2倍标准差）
  - 正常：其他
- 标签选择策略：
  - 恐慌：中周期标签（5日收益，避免追涨杀跌）
  - 贪婪：长周期标签（10日收益，耐心持有）
  - 正常：短周期标签（2日收益）
- 设计理念：适应情绪极端情况
- 预期效果：极端情绪下表现更稳定（最大回撤降低8-12%）
- 优势：规避情绪风险
- 劣势：情绪识别不稳定

**配置6: 学习最优切换策略**
- 训练阶段：
  - 记录不同市场环境下各标签的历史表现
  - 构建"环境→最优标签"映射表
- 测试阶段：
  - 根据当前环境特征查找历史最优标签
  - 使用该标签进行预测
- 设计理念：数据驱动的自适应策略
- 环境特征：波动率、ADX、大盘方向、换手率等
- 预期效果：可能优于手工规则（年化收益提升2-5%）
- 优势：自适应优化，避免人工调参
- 劣势：需要充足的历史数据

**关键假设**：
- 不同市场环境下最优标签不同
- 自适应标签可能应对不同市场环境
- 但增加系统复杂度和实现难度
- 数据驱动的策略（配置6）可能优于手工规则（配置1-5）

**评估方法**：
- 分析不同市场环境下的性能差异（分组统计）
- 对比自适应 vs 固定标签（全年、牛市、熊市、震荡市）
- 计算环境切换频率（避免过度切换）
- 评估策略稳定性（不同时期表现一致性）

---

## 4. 实验执行与评估流程

### 4.1 执行顺序

```
实验0（Baseline训练）
    ↓
实验1（单周期扫描）→ 确定最优单周期
    ↓
实验2（多周期组合）→ 确定最优组合
    ↓
实验3（风险调整）→ 与最优组合对比，选择最优风险调整
    ↓
实验4（排序标签）→ 评估排序标签效果
    ↓
实验5（分位数回归）→ 确定最优分位数
    ↓
实验6（多目标）→ 评估多目标学习效果
    ↓
实验7（自适应标签）→ 评估动态调整效果
    ↓
综合分析与最优配置推荐
```

### 4.2 结果记录

每个实验需要记录以下指标：

| 指标类别 | 具体指标 | 说明 |
|---------|---------|------|
| 预测准确性 | IC | 信息系数 |
| | Rank IC | 排序相关系数 |
| | ICIR | IC信息比率（IC/IC标准差） |
| 收益表现 | 年化收益率 | 主要指标 |
| | 累计收益率 | 测试期总收益 |
| 风险指标 | 夏普比率 | 风险调整收益 |
| | 最大回撤 | 最大损失幅度 |
| | Calmar比率 | 年化收益/最大回撤 |
| | Sortino比率 | 下行风险调整收益 |
| | 波动率 | 年化波动率 |
| 交易指标 | 换手率 | 反映交易频率 |
| | 月均交易次数 | 交易活跃度 |
| 稳定性 | IC月度标准差 | 预测稳定性 |
| | 月度胜率 | 盈利月份占比 |
| 相对提升 | 相对Baseline提升百分比 | 所有指标 |

### 4.3 可视化分析

**关键图表清单**：

1. **单周期分析图**
   - 年化收益率 vs 周期长度（折线图）
   - IC vs 周期长度（折线图）
   - 换手率 vs 周期长度（折线图）
   - 三指标叠加图（双Y轴）

2. **多周期对比图**
   - 各配置性能对比（柱状图）
   - 权重分配热力图（配置×周期）
   - IC标准差对比（柱状图）

3. **风险调整分析图**
   - Sharpe/Calmar/Sortino对比（柱状图）
   - 收益-回撤散点图（各配置）
   - 风险调整收益 vs 原始收益

4. **排序标签分析图**
   - 预测排序 vs 真实排序散点图
   - Top-K准确率曲线
   - 分位数标签性能对比（箱线图）

5. **分位数回归图**
   - 不同分位数的收益对比（箱线图）
   - 分位数 vs 风险指标（折线图）
   - 预测分位数 vs 真实分位数散点图

6. **多目标分析图**
   - 帕累托前沿图（收益-风险-流动性）
   - 各目标贡献分析（雷达图）
   - 权重敏感性分析图

7. **自适应标签图**
   - 市场环境时间序列图（标注切换点）
   - 不同环境下性能对比（分组柱状图）
   - 标签切换频率统计

---

## 5. 预期贡献

### 5.1 学术贡献

- **系统性研究**：首次系统性研究标签设计对pairwise排序学习的影响
- **实证分析**：提供不同标签特性的量化比较（A股市场）
- **设计原则**：为量化投资中的标签设计提供理论指导和实证依据

### 5.2 实践贡献

- **最优标签推荐**：基于A股实证数据的最优标签配置
- **性能提升**：预期年化收益提升2-6%，夏普比率提升0.1-0.3
- **稳定性提升**：预期ICIR提升10-20%，增强策略可靠性

---

## 6. 时间估算

| 实验编号 | 实验名称 | 配置数量 | 预计耗时（小时） |
|---------|---------|---------|----------------|
| 0 | Baseline标签 | 1 | 2-3 |
| 1 | 单周期扫描 | 6 | 8-12 |
| 2 | 多周期组合 | 6 | 8-12 |
| 3 | 风险调整 | 5 | 6-10 |
| 4 | 排序标签 | 6 | 8-12 |
| 5 | 分位数回归 | 5 | 6-10 |
| 6 | 多目标 | 6 | 8-12 |
| 7 | 自适应标签 | 6 | 8-12 |
| **总计** | | | **54-93 小时** |

**建议执行周期**：2-3周（每周20-30小时计算时间）

---

## 7. 成功标准

**实验计划成功的标志**：
1. ✓ 找到相对于Baseline有显著提升（年化收益>2%）的最优标签设计
2. ✓ 理解不同标签特性对性能的影响规律
3. ✓ 形成可复现的标签选择决策树
4. ✓ 完成实验报告与可视化分析
5. ✓ 提供明确的标签配置推荐（适合不同风险偏好投资者）
